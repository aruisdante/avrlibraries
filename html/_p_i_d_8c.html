<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PID.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PID.c File Reference</h1>
<p>Library of functions for PID control.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="_p_i_d_8h_source.html">PID.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_simple___serial_8h_source.html">Simple_Serial.h</a>&quot;</code><br/>
<code>#include &quot;Timer8_Functions.h&quot;</code><br/>
<code>#include &quot;DAC.h&quot;</code><br/>
<code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;avr/interrupt.h&gt;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#afd579125cbb0710cf36c6688f272b966">SCALE1</a>&nbsp;&nbsp;&nbsp;1000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#aa0141381f267dfc050107e7c5b0d67c1">SCALE2</a>&nbsp;&nbsp;&nbsp;10000</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#aa1119e5ecd1e98ca065e95119574fc05">PID_Initialize</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes PID control.  <a href="#aa1119e5ecd1e98ca065e95119574fc05"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_p_i_d___c_h_a_n_n_e_l.html">PID_CHANNEL</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#a566367e7249999c52d04102587ed2356">PID_Add_Channel</a> (int *target, int *current, int *correctionValue, int *LMDVal, int Kp, int Ki, int Kd, char spool)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a PID channel to the PID controller.  <a href="#a566367e7249999c52d04102587ed2356"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#a781bfbd112229959a281103e6997f6e0">PID_Proportional</a> (int *error, int *Kp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculates the proportional element of PID  <a href="#a781bfbd112229959a281103e6997f6e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#af53da3af33f1ef9c8c504e7905864e54">PID_Integral</a> (int *errorSum, int *Ki)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculates the integral element of PID  <a href="#af53da3af33f1ef9c8c504e7905864e54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#a463084f427720394cce958eed999a4dd">PID_Derivative</a> (int *error, int *lastError, int *Kd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculates the derivative element of PID  <a href="#a463084f427720394cce958eed999a4dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#a7efb1c6c42251234859815a27ce49627">PID</a> (<a class="el" href="struct_p_i_d___c_h_a_n_n_e_l.html">PID_CHANNEL</a> *PIDchan)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculates PID  <a href="#a7efb1c6c42251234859815a27ce49627"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#af8e0f3873686dd93a84a2b98720e6165">PID_CorrectionVal_to_Volts</a> (int correctionVal)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Turns the unit-less number returned by the PID loop into a voltage value for the LMD.  <a href="#af8e0f3873686dd93a84a2b98720e6165"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#aec43762dc86e029b395d4e5819192c2d">ISR</a> (TIMER0_COMPA_vect)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ISR handler that uses timer 0 to update the PID controller.  <a href="#aec43762dc86e029b395d4e5819192c2d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#ac05daeebea73d0c1095389331b55eeae">Pot_To_Degrees</a> (int potVal, int channel)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Converts a 10bit pot value to an angle in degrees.  <a href="#ac05daeebea73d0c1095389331b55eeae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#aa3a17ec06666bff62c3227cfc8d9d4aa">Degrees_To_Pot</a> (int degrees, int channel)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Converts an angle in degrees to a 10bit pot value.  <a href="#aa3a17ec06666bff62c3227cfc8d9d4aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#aa619c652b67ff74d33c483456d79d0ea">Calc_Transfer_Function</a> (int *X1, int *Y1, int *X2, int *Y2, int *slope, int *intercept, int scale)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculates a linear transfer function's slope and offset, with the slope multiplied by scale to allow for inter only math  <a href="#aa619c652b67ff74d33c483456d79d0ea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_p_o_t___a_n_g_l_e.html">POT_ANGLE</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_p_i_d_8c.html#a07945831317c390e4224788ceb04d95a">Add_Pot_Angle</a> (int valMax, int angMax, int valMin, int angMin, char *name, char channel)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function creates a <a class="el" href="struct_p_o_t___a_n_g_l_e.html">POT_ANGLE</a> struct.  <a href="#a07945831317c390e4224788ceb04d95a"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Library of functions for PID control. </p>
<dl class="date"><dt><b>Date:</b></dt><dd>Feb 2, 2010 </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Adam Panzica </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>1.0 Initial version with functions: <a class="el" href="_p_i_d_8c.html#aa1119e5ecd1e98ca065e95119574fc05" title="Initializes PID control.">PID_Initialize()</a>, *PID_Add_Channel(), <a class="el" href="_p_i_d_8c.html#a781bfbd112229959a281103e6997f6e0" title="calculates the proportional element of PID">PID_Proportional()</a>, <a class="el" href="_p_i_d_8c.html#af53da3af33f1ef9c8c504e7905864e54" title="calculates the integral element of PID">PID_Integral()</a>, <a class="el" href="_p_i_d_8c.html#a463084f427720394cce958eed999a4dd" title="calculates the derivative element of PID">PID_Derivative()</a>, <a class="el" href="_p_i_d_8c.html#a7efb1c6c42251234859815a27ce49627" title="calculates PID">PID()</a>, <a class="el" href="_p_i_d_8c.html#af8e0f3873686dd93a84a2b98720e6165" title="Turns the unit-less number returned by the PID loop into a voltage value for the...">PID_CorrectionVal_to_Volts()</a>, and <a class="el" href="_p_i_d_8c.html#aec43762dc86e029b395d4e5819192c2d" title="ISR handler that uses timer 0 to update the PID controller.">ISR(TIMER0_COMPA_vect)</a> </dd>
<dd>
2.0 Added pot functions to allow for dynamic configuration of pot scaling factors. </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="afd579125cbb0710cf36c6688f272b966"></a><!-- doxytag: member="PID.c::SCALE1" ref="afd579125cbb0710cf36c6688f272b966" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCALE1&nbsp;&nbsp;&nbsp;1000</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Scale factor for Degree to Pot conversion </p>

</div>
</div>
<a class="anchor" id="aa0141381f267dfc050107e7c5b0d67c1"></a><!-- doxytag: member="PID.c::SCALE2" ref="aa0141381f267dfc050107e7c5b0d67c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCALE2&nbsp;&nbsp;&nbsp;10000</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Scale factor for Pot to Degree conversion </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a07945831317c390e4224788ceb04d95a"></a><!-- doxytag: member="PID.c::Add_Pot_Angle" ref="a07945831317c390e4224788ceb04d95a" args="(int valMax, int angMax, int valMin, int angMin, char *name, char channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_p_o_t___a_n_g_l_e.html">POT_ANGLE</a> * Add_Pot_Angle </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>valMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>angMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>valMin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>angMin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>channel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function creates a <a class="el" href="struct_p_o_t___a_n_g_l_e.html">POT_ANGLE</a> struct. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>valMax</em>&nbsp;</td><td>ADC value at maximum angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angMax</em>&nbsp;</td><td>Angle at maximum ADC value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>valMin</em>&nbsp;</td><td>ADC value at minimum angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angMin</em>&nbsp;</td><td>Angle at minimum ADC value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*name</em>&nbsp;</td><td>pointer to an array of chars containing the name of the angle (max 15 chars) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>channel</em>&nbsp;</td><td>ADC channel that the pot is on </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa619c652b67ff74d33c483456d79d0ea"></a><!-- doxytag: member="PID.c::Calc_Transfer_Function" ref="aa619c652b67ff74d33c483456d79d0ea" args="(int *X1, int *Y1, int *X2, int *Y2, int *slope, int *intercept, int scale)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Calc_Transfer_Function </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>X1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>Y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>X2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>Y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>intercept</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>scale</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates a linear transfer function's slope and offset, with the slope multiplied by scale to allow for inter only math </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*X1</em>&nbsp;</td><td>pointer to the lower X bound of the transfer function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*Y1</em>&nbsp;</td><td>pointer to the lower Y bound of the transfer function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*X2</em>&nbsp;</td><td>pointer to the upper X bound of the transfer function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*Y2</em>&nbsp;</td><td>pointer to the upper Y bound of the transfer function </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*slope</em>&nbsp;</td><td>pointer to a variable to store the slope to </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*intercept</em>&nbsp;</td><td>point to a variable to store the intercept to </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>scale</em>&nbsp;</td><td>scale factor to multiply the slope by </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa3a17ec06666bff62c3227cfc8d9d4aa"></a><!-- doxytag: member="PID.c::Degrees_To_Pot" ref="aa3a17ec06666bff62c3227cfc8d9d4aa" args="(int degrees, int channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Degrees_To_Pot </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>degrees</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>channel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Converts an angle in degrees to a 10bit pot value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>degrees</em>&nbsp;</td><td>angle in degrees </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>10bit pot value</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>degrees</em>&nbsp;</td><td>angle in degrees </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>channel</em>&nbsp;</td><td>channel to use for the conversion </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>10bit pot value </dd></dl>

</div>
</div>
<a class="anchor" id="aec43762dc86e029b395d4e5819192c2d"></a><!-- doxytag: member="PID.c::ISR" ref="aec43762dc86e029b395d4e5819192c2d" args="(TIMER0_COMPA_vect)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">TIMER0_COMPA_vect&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ISR handler that uses timer 0 to update the PID controller. </p>
<p>This function does all of the calculations to update the state of the PID controller. It is called every time that the counter in Timer 0 overflows. This allows the user to set up a set refresh rate for the PID controller independent of external factors. </p>

</div>
</div>
<a class="anchor" id="a7efb1c6c42251234859815a27ce49627"></a><!-- doxytag: member="PID.c::PID" ref="a7efb1c6c42251234859815a27ce49627" args="(PID_CHANNEL *PIDchan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_p_i_d___c_h_a_n_n_e_l.html">PID_CHANNEL</a> *&nbsp;</td>
          <td class="paramname"> <em>PIDchan</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates PID </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*PIDchan</em>&nbsp;</td><td>pointer to a <a class="el" href="struct_p_i_d___c_h_a_n_n_e_l.html" title="this strcut defines a PID_CHANNEL object">PID_CHANNEL</a> struct </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a correction value using PID</dd></dl>
<p>This function calculates a PID correction factor following the function PID= P+I+D </p>

</div>
</div>
<a class="anchor" id="a566367e7249999c52d04102587ed2356"></a><!-- doxytag: member="PID.c::PID_Add_Channel" ref="a566367e7249999c52d04102587ed2356" args="(int *target, int *current, int *correctionValue, int *LMDVal, int Kp, int Ki, int Kd, char spool)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_p_i_d___c_h_a_n_n_e_l.html">PID_CHANNEL</a> * PID_Add_Channel </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>correctionValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>LMDVal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Ki</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>spool</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds a PID channel to the PID controller. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*target</em>&nbsp;</td><td>pointer to the target value for this PID channel </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*current</em>&nbsp;</td><td>pointer to the current value for this PID channel </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*correctionValue</em>&nbsp;</td><td>pointer to a location to write the correction value from this PID channel </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*LMDVal</em>&nbsp;</td><td>pointer to a location to write the requested LMD output voltage to. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>Kp</em>&nbsp;</td><td>Proportional gain constant </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>Ki</em>&nbsp;</td><td>Integral gain constant </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>Kd</em>&nbsp;</td><td>Derivative gain constant </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>spool</em>&nbsp;</td><td>Cap value for the Integral element of the PID loop to prevent it from dominating the system </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to the added PID channel</dd></dl>
<p>This function adds a PID channel to the PID controller. It is automatically handled from the moment it is added. Communication with the controller is handled by updating the input communication vars, *target and *current. Write to target to change the value that the PID loop seeks, and update current as often as possible to ensure that the PID loop has accurate current state information. The output states of the PID loop can be checked by reading the contents of *correctionVal and *LMDVal </p>

</div>
</div>
<a class="anchor" id="af8e0f3873686dd93a84a2b98720e6165"></a><!-- doxytag: member="PID.c::PID_CorrectionVal_to_Volts" ref="af8e0f3873686dd93a84a2b98720e6165" args="(int correctionVal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PID_CorrectionVal_to_Volts </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>correctionVal</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Turns the unit-less number returned by the PID loop into a voltage value for the LMD. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>correctionVal</em>&nbsp;</td><td>PID value to be converted into a voltage </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A voltage value between -12000 and 12000 mV This function converts the arbitrary, unit-less number returned by the PID loop into a voltage value between -12000 and 12000 mV that can be used to set the LMD to control motors </dd></dl>

</div>
</div>
<a class="anchor" id="a463084f427720394cce958eed999a4dd"></a><!-- doxytag: member="PID.c::PID_Derivative" ref="a463084f427720394cce958eed999a4dd" args="(int *error, int *lastError, int *Kd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PID_Derivative </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>lastError</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>Kd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates the derivative element of PID </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*error</em>&nbsp;</td><td>pointer to an error value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*lastError</em>&nbsp;</td><td>point to the previous error value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*Kd</em>&nbsp;</td><td>pointer to the derivative gain </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the derivative element of PID</dd></dl>
<p>This function calculates the derivative element of a PID control loop based off a passed error and last error value and a gain constant, following the function D=(E2-E1)/time*Kd </p>

</div>
</div>
<a class="anchor" id="aa1119e5ecd1e98ca065e95119574fc05"></a><!-- doxytag: member="PID.c::PID_Initialize" ref="aa1119e5ecd1e98ca065e95119574fc05" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PID_Initialize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes PID control. </p>
<p>This function initializes PID by setting up the 8bit timer to refresh at a set frequency. The actual PID calculations are called from the ISR for this timer </p>

</div>
</div>
<a class="anchor" id="af53da3af33f1ef9c8c504e7905864e54"></a><!-- doxytag: member="PID.c::PID_Integral" ref="af53da3af33f1ef9c8c504e7905864e54" args="(int *errorSum, int *Ki)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PID_Integral </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>errorSum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>Ki</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates the integral element of PID </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*errorSum</em>&nbsp;</td><td>pointer to a value corresponding to the sum of errors </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*Ki</em>&nbsp;</td><td>pointer to the integral gain </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the integral element of PID</dd></dl>
<p>This function calculates the integral element of a PID control loop based off a passed sum of errors value and a gain constant, following the function I=sum(E)/time*Ki </p>

</div>
</div>
<a class="anchor" id="a781bfbd112229959a281103e6997f6e0"></a><!-- doxytag: member="PID.c::PID_Proportional" ref="a781bfbd112229959a281103e6997f6e0" args="(int *error, int *Kp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PID_Proportional </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>Kp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates the proportional element of PID </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*error</em>&nbsp;</td><td>pointer to an error value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*Kp</em>&nbsp;</td><td>pointer to the proportional gain </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the proportional element of PID</dd></dl>
<p>This function calculates the proportional element of a PID control loop based off a passed error value and a gain constant, following the function P=Kp*E </p>

</div>
</div>
<a class="anchor" id="ac05daeebea73d0c1095389331b55eeae"></a><!-- doxytag: member="PID.c::Pot_To_Degrees" ref="ac05daeebea73d0c1095389331b55eeae" args="(int potVal, int channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Pot_To_Degrees </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>potVal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>channel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Converts a 10bit pot value to an angle in degrees. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>potVal</em>&nbsp;</td><td>10bit pot value </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>angle in degrees</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>potVal</em>&nbsp;</td><td>10bit pot value </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>channel</em>&nbsp;</td><td>channel to use for the conversion </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>angle in degrees </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
